# University-cyber-drill-2021-reverse-Engineering-writeup

## Reverse Engineering 
রিভার্স ইঞ্জিনেরিং এ অনেক ধরনের টুলস ইউস করা হয়, লিনাক্স বাইনারি ক্রেক করার জন্য Ghidra, gdb, IDA, Cutter etc. তবে লিনাক্স এর ক্ষেত্রে ফেভারিট টুল হলো Cutter. আর Windows এর ক্ষেত্রে DNSpy. android এর ক্ষেত্রে show java. আমি সাইবার ড্রীল এর প্রবলেম দুটো CUtter সফটওয়্যার দিয়ে করেছি। এখানে ইউনিভার্সিটি সাইবার ড্রিল ২০২১ এ আমার রিভার্স ইঞ্জিনেরিং করার টেকনিক গুলো শেয়ার করবো।
আশা করি আমার লেখা পরে রিভার্স ইঞ্জিনিয়ারিং সম্পর্কে ধারনা নিতে পারবেন। যদিও এটা বিগিনার গাইড না। 

#### Terminator : 100
Don't come with me if you want to live.

Please find the flag from the attached [file](/lib/TERMINATOR).

The format of this flag is UNICTF{flag}
### Solution

প্রথমে আমি বাইনারি ফাইলটি লিনাক্স এ রান করি আর্গুমেন্ট ছাড়া এবং সহ। তখন এই আউটপুট গুলি দেখতে পাই।

![1.1](/lib/1.1.png)

তারপর Cutter টুল দিয়ে ওপেন করি এবং ফাংশন গুলো বুঝার ট্রাই করি ।
প্রথমত দেখলাম main ফাংধন টি আরেকটা cyber_drill2021_main() ফাংশন কে কল করতেছে আর্গুমেন্ট সহ। 

![1.2](/lib/1.2.png)

cyber_drill2021_main() ফাংশন এর কোড নিম্নরুপঃ

![১.৩](/lib/1.3.png)

কিছুক্ষন বুঝার ট্রাই করে বুজতে পারলাম যে যদি রান করার সময় কোনো আর্গুমেন্ট না দেই তাহলে Almost there ........ প্রিন্ট করবে। আর দিলে কিছু প্রসেসিং করে cVar2  varilable e কিছু Data store করবে। যদি cVar2 এর মান NULL হয় তাহলে আমাদের কাঙ্খিত ফ্লাগ পাবো। অনেক্ষন এইটা নিয়া বিভিন্ ভাবে  ডিবাগ করে বুজতে পারলাম যে NULL বানালো প্রায় অসম্ভব। 
তাই আমি ভিন্ন রাস্তা খুজার ট্রাই করি । এসেম্বলি লেঙ্গুয়েজ নিয়ে ঘাটা ঘাটি করে বুজতে পারমাল যদি আমি প্রথম if স্টেটমেন্ট এর পর সরাসরি ফ্লাগ বের করার কোড গুলো একসেস করতে পারি তাহলেই আমি আমার কাঙ্ক্ষিত রেজাল্ট পেয়ে যাব । তাই আমি ইফ এর পর ELSE জায়গায় ( যা এসেম্বলি তে jne দারা বুঝানো হয়) পরবর্তী ইফ এর ভিতরের কোড নির্দেশ করাই instuctor point change করে। যা প্রথমত পরবর্তী ইফ কে নির্দেশ করতেছিল যার এড্রেস 0x14b6 আমি টা পরিবরতন করে 0x155d করে দেই যেখান থেকে ফ্লাগ বের করার কোড শুরু হইছে। 

![১.৪](/lib/1.4.png)

যা পরিবরতিত হয়ে নিচের মত হয়েছেঃ

![১.৫](/lib/1.5.png)

কোড আকারে নিচের মতঃ

![১.৬](/lib/1.6.png)

এখন সেভ করে রান করি এবং ফ্লাগ টা পেয়ে যাই।

![১.৭](/lib/1.7.png)

Flag: `7e5671326f1c4b80cfb75134471eb2`


